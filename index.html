<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Happy Anniversary Ridho & Lili ‚ù§Ô∏è</title>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@300;500;700&family=Sacramento&display=swap" rel="stylesheet">
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <style>
    :root {
      --primary: #ff4d6d;
      --secondary: #590d22;
      --accent: #ffccd5;
      --bg-color: #0b0f19;
      --glass: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.2);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Quicksand', sans-serif;
      background: var(--bg-color);
      color: white;
      height: 100vh;
      overflow: hidden; /* Body tetap tidak scroll, scroll diatur per section */
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    /* --- BACKGROUND --- */
    .background-anim {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      z-index: 0;
      background: linear-gradient(125deg, #1a1a2e, #16213e, #1a1a2e);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(60px);
      opacity: 0.5;
      animation: floatOrb 10s infinite alternate;
    }
    .orb-1 { width: 300px; height: 300px; background: #ff4d6d; top: -50px; left: -50px; }
    .orb-2 { width: 200px; height: 200px; background: #590d22; bottom: 10%; right: 10%; animation-delay: -5s; }
    
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes floatOrb {
      0% { transform: translate(0, 0); }
      100% { transform: translate(30px, 50px); }
    }

    /* --- FLASH EFFECT --- */
    #flash-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: white;
      z-index: 9999;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.1s ease-out;
    }

    /* --- CONTAINER --- */
    .container {
      position: relative;
      z-index: 10;
      width: 100%;
      max-width: 450px;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      overflow: hidden; /* Mencegah double scrollbar */
    }

    /* --- SECTIONS --- */
    #section-intro {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 100%;
      text-align: center;
      animation: float 3s ease-in-out infinite;
    }

    .title-anniversary {
      font-family: 'Sacramento', cursive;
      font-size: 3.5rem;
      color: #ff8fa3;
      text-shadow: 0 0 15px rgba(255, 77, 109, 0.8);
      margin-bottom: 5px;
    }

    .subtitle-names {
      font-size: 1.2rem;
      letter-spacing: 3px;
      margin-bottom: 40px;
      color: #fff0f3;
      text-transform: uppercase;
      border-bottom: 1px solid var(--primary);
      display: inline-block;
      padding-bottom: 5px;
    }

    .heart-btn {
      width: 100px;
      height: 100px;
      background: radial-gradient(circle at 30% 30%, #ff4d6d, #800f2f);
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 0 30px rgba(255, 77, 109, 0.6);
      transition: transform 0.3s;
      margin: 0 auto;
      position: relative;
      z-index: 20;
    }
    .heart-btn:active { transform: scale(0.9); }
    .heart-btn i { font-size: 2.5rem; color: white; }

    #section-letter {
      display: none;
      width: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(10px);
      padding: 30px;
      border-radius: 20px;
      border: 1px solid var(--glass-border);
      text-align: left;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      /* Jaga-jaga jika suratnya panjang */
      max-height: 80vh;
      overflow-y: auto;
    }

    .typewriter-content {
      font-family: 'Dancing Script', cursive;
      font-size: 1.5rem;
      line-height: 1.6;
      color: #fff0f3;
      min-height: 200px;
      white-space: pre-wrap;
    }

    .next-btn {
      margin-top: 20px;
      padding: 10px 25px;
      background: var(--primary);
      border: none;
      color: white;
      border-radius: 50px;
      cursor: pointer;
      font-weight: bold;
      float: right;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    .next-btn.show { opacity: 1; transform: translateY(0); }

    /* --- UPDATE: SECTION GALLERY SCROLLABLE --- */
    #section-gallery {
      display: none;
      width: 100%;
      height: 100%;
      flex-direction: column;
      justify-content: flex-start;
      padding-top: 20px;
      
      /* Perbaikan Scroll Mobile */
      overflow-y: auto; /* Mengaktifkan scroll vertikal */
      padding-bottom: 100px; /* Memberi ruang di bawah agar tombol tidak tertutup */
      -webkit-overflow-scrolling: touch; /* Smooth scroll untuk iOS */
      scrollbar-width: none; /* Menyembunyikan scrollbar di Firefox */
    }
    /* Menyembunyikan scrollbar di Chrome/Safari */
    #section-gallery::-webkit-scrollbar {
      display: none;
    }

    .timer-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
      padding: 15px;
      border-radius: 15px;
      text-align: center;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      flex-shrink: 0; /* Mencegah timer mengecil */
    }
    .timer-title { font-size: 0.8rem; letter-spacing: 1px; color: #ffccd5; }
    .timer-display { font-size: 1rem; font-weight: bold; margin-top: 5px; }

    .media-frame {
      width: 100%;
      height: 280px;
      background: #000;
      border-radius: 20px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      border: 2px solid var(--glass-border);
      margin-bottom: 15px;
      /* Untuk Spotify Card */
      display: flex;
      justify-content: center;
      align-items: center;
      flex-shrink: 0; /* Mencegah frame mengecil */
    }
    .media-frame img { width: 100%; height: 100%; object-fit: cover; }
    
    /* --- SPOTIFY CARD STYLE --- */
    .spotify-card {
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, #1db954 0%, #191414 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: white;
      text-align: center;
    }
    
    .spotify-img {
      width: 120px;
      height: 120px;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      border: 2px solid rgba(255,255,255,0.2);
    }
    .spotify-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .spotify-info h3 { font-size: 1.2rem; margin-bottom: 5px; font-weight: bold; }
    .spotify-info p { font-size: 0.9rem; opacity: 0.8; margin-bottom: 15px; }

    .play-circle-btn {
      width: 50px;
      height: 50px;
      background: #1db954;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      color: black;
      font-size: 20px;
      transition: transform 0.2s;
    }
    .play-circle-btn:hover { transform: scale(1.1); }
    .play-circle-btn:active { transform: scale(0.95); }
    .play-circle-btn.playing i { content: "\f04c"; /* FontAwesome Pause Icon */ }

    .caption-box { text-align: center; min-height: 50px; font-style: italic; color: #e0e0e0; margin-bottom: 10px; font-size: 0.95rem; flex-shrink: 0; }

    .gallery-nav { display: flex; justify-content: center; gap: 20px; margin-bottom: 10px; flex-shrink: 0; }
    .nav-btn { background: transparent; border: 1px solid var(--primary); color: var(--primary); width: 40px; height: 40px; border-radius: 50%; cursor: pointer; transition: 0.3s; }
    .nav-btn:hover { background: var(--primary); color: white; }

    .special-btn-container { text-align: center; margin-top: auto; padding-bottom: 20px; flex-shrink: 0; }
    .love-btn {
      background: linear-gradient(45deg, #ff4d6d, #ff758f);
      border: none; padding: 12px 25px; border-radius: 30px;
      color: white; cursor: pointer; font-weight: bold;
      box-shadow: 0 5px 15px rgba(255, 77, 109, 0.4);
      transition: transform 0.2s;
    }
    .love-btn:active { transform: scale(0.95); }

    #section-reason {
      display: none;
      width: 100%;
      height: 100%;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      animation: fadeIn 0.5s forwards;
      overflow-y: auto; /* Jaga-jaga jika layar sangat pendek */
    }

    .reason-card {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      padding: 40px 20px;
      border-radius: 20px;
      width: 100%;
      border: 1px solid rgba(255,255,255,0.3);
      margin-bottom: 30px;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .reason-text { font-size: 1.5rem; font-family: 'Dancing Script', cursive; color: #fff; }
    .reason-actions { display: flex; gap: 15px; }
    .btn-secondary { background: transparent; border: 1px solid white; color: white; }

    /* --- MUSIC PLAYER UI --- */
    .music-player {
      position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px;
      background: rgba(20, 20, 20, 0.8); border-radius: 50%;
      display: flex; justify-content: center; align-items: center;
      cursor: pointer; border: 2px solid rgba(255,255,255,0.2); z-index: 100;
      transition: all 0.3s;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .music-player i { transition: transform 0.5s; color: #ff4d6d; }
    .music-player.playing { border-color: #ff4d6d; box-shadow: 0 0 20px #ff4d6d; }
    .music-player.playing i { animation: spin 4s linear infinite; }

    /* Hidden SoundCloud Iframes */
    .hidden-sc {
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      pointer-events: none;
    }

    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
  </style>
</head>
<body>

  <div id="flash-overlay"></div>
  <div class="background-anim">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
  </div>

  <!-- 1. BG MUSIC PLAYER (PIRINGAN) -->
  <!-- Track: Jeremy McClain - Best Part -->
  <iframe id="sc-bg-music" class="hidden-sc" width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay"
    src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/jeremy-mcclain-383700971/best-part-1&color=%23ff5500&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false&visual=false">
  </iframe>
  
  <!-- 2. GALLERY MUSIC PLAYER (SAL PRIADI) -->
  <!-- Track: Sal Priadi - Kita Usahakan Rumah Itu -->
  <iframe id="sc-gallery-music" class="hidden-sc" width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay"
    src="https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/fera-freesh/sal-priadi-kita-usahakan-rumah&color=%231db954&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false&visual=false">
  </iframe>
  
  <!-- MUSIC TOGGLE BUTTON (VINYL) -->
  <div class="music-player" onclick="toggleBgMusic()" title="Background Music">
    <i class="fas fa-compact-disc" style="font-size: 30px;"></i>
  </div>

  <div class="container">
    
    <!-- 1. INTRO -->
    <div id="section-intro">
      <h1 class="title-anniversary">Happy 1st Anniversary</h1>
      <h2 class="subtitle-names">Ridho & Lili</h2>
      <div class="heart-btn" onclick="startExperience()">
        <i class="fas fa-heart"></i>
      </div>
      <p style="margin-top:15px; font-size: 0.8rem; opacity: 0.7;">Klik hati untuk memulai</p>
    </div>

    <!-- 2. LETTER -->
    <div id="section-letter">
      <div id="typewriterText" class="typewriter-content"></div>
      <button id="btnLanjut" class="next-btn" onclick="goToGallery()">Lanjut <i class="fas fa-arrow-right"></i></button>
    </div>

    <!-- 3. GALLERY -->
    <div id="section-gallery">
      <div class="timer-card">
        <div class="timer-title">KITA SUDAH BERSAMA SELAMA</div>
        <div id="timerDisplay" class="timer-display">...</div>
      </div>

      <div class="media-frame" id="mediaFrame">
        <!-- Content injected via JS -->
      </div>
      
      <div class="caption-box">
        <p id="captionText">...</p>
      </div>

      <div class="gallery-nav">
        <button class="nav-btn" onclick="changeSlide(-1)"><i class="fas fa-chevron-left"></i></button>
        <button class="nav-btn" onclick="changeSlide(1)"><i class="fas fa-chevron-right"></i></button>
      </div>

      <div class="special-btn-container">
        <button class="love-btn" onclick="goToReason()">Kenapa Aku Sayang Kamu? ‚ú®</button>
      </div>
    </div>

    <!-- 4. REASON -->
    <div id="section-reason">
      <h2 style="margin-bottom: 20px; font-family: 'Sacramento', cursive; font-size: 2.5rem;">Alasannya adalah...</h2>
      <div class="reason-card">
        <p id="reasonText" class="reason-text">...</p>
      </div>
      <div class="reason-actions">
        <button class="love-btn btn-secondary" onclick="backToGallery()">Kembali</button>
        <button class="love-btn" onclick="generateReason()">Cari Alasan Lain üé≤</button>
      </div>
    </div>

  </div>

  <!-- SOUNDCLOUD WIDGET API -->
  <script src="https://w.soundcloud.com/player/api.js"></script>

  <script>
    // --- SETUP SOUNDCLOUD WIDGETS ---
    var bgWidget = SC.Widget(document.getElementById('sc-bg-music'));
    var galleryWidget = SC.Widget(document.getElementById('sc-gallery-music'));
    
    var isBgPlaying = false;
    var isGalleryPlaying = false;
    
    var musicIcon = document.querySelector('.music-player');

    // Init Volume
    bgWidget.bind(SC.Widget.Events.READY, function() { bgWidget.setVolume(50); });
    galleryWidget.bind(SC.Widget.Events.READY, function() { galleryWidget.setVolume(80); });

    // Loop Fix
    bgWidget.bind(SC.Widget.Events.FINISH, function() { bgWidget.seekTo(0); bgWidget.play(); });
    galleryWidget.bind(SC.Widget.Events.FINISH, function() { 
      // Stop gallery music when finished
      isGalleryPlaying = false;
      renderPlayButtonState();
    });

    // Control Functions
    function toggleBgMusic() {
      if (isBgPlaying) {
        bgWidget.pause();
        musicIcon.classList.remove('playing');
        isBgPlaying = false;
      } else {
        // Matikan gallery music jika nyala
        if(isGalleryPlaying) toggleGalleryMusic(true); 
        
        bgWidget.play();
        musicIcon.classList.add('playing');
        isBgPlaying = true;
      }
    }

    function toggleGalleryMusic(forceStop = false) {
      const playBtn = document.getElementById('spotifyPlayBtn');
      const icon = playBtn ? playBtn.querySelector('i') : null;

      if (isGalleryPlaying || forceStop) {
        galleryWidget.pause();
        isGalleryPlaying = false;
        if(icon) icon.className = "fas fa-play";
        
        // Jika distop manual dan kita masih di halaman, mungkin mau resume BG music?
        // Optional: uncomment below to resume BG music automatically
        // toggleBgMusic(); 
      } else {
        // Matikan BG music dulu
        if(isBgPlaying) toggleBgMusic(); 

        galleryWidget.play();
        isGalleryPlaying = true;
        if(icon) icon.className = "fas fa-pause";
      }
    }

    // Helper untuk update UI tombol play di card
    function renderPlayButtonState() {
      const playBtn = document.getElementById('spotifyPlayBtn');
      if(!playBtn) return;
      const icon = playBtn.querySelector('i');
      if(isGalleryPlaying) {
        icon.className = "fas fa-pause";
      } else {
        icon.className = "fas fa-play";
      }
    }

    // --- WEB AUDIO API (SFX) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playShutterSound() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const t = audioCtx.currentTime;
        
        // Noise
        const bufferSize = audioCtx.sampleRate * 0.1; 
        const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
        
        const noise = audioCtx.createBufferSource();
        noise.buffer = buffer;
        const noiseGain = audioCtx.createGain();
        noise.connect(noiseGain);
        noiseGain.connect(audioCtx.destination);
        noiseGain.gain.setValueAtTime(0.5, t);
        noiseGain.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
        noise.start(t);

        // Tone
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        osc.type = 'triangle';
        osc.frequency.setValueAtTime(1200, t);
        osc.frequency.exponentialRampToValueAtTime(100, t + 0.15);
        gainNode.gain.setValueAtTime(0.3, t);
        gainNode.gain.exponentialRampToValueAtTime(0.01, t + 0.15);
        osc.start(t);
        osc.stop(t + 0.2);
    }

    function playTypingSound() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const t = audioCtx.currentTime;
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        osc.type = 'sine';
        const pitch = 600 + Math.random() * 200; 
        osc.frequency.setValueAtTime(pitch, t);
        osc.frequency.exponentialRampToValueAtTime(pitch/2, t + 0.05);
        gainNode.gain.setValueAtTime(0.1, t);
        gainNode.gain.exponentialRampToValueAtTime(0.01, t + 0.05);
        osc.start(t);
        osc.stop(t + 0.05);
    }

    // --- KONTEN ---
    const startDate = new Date(2023, 0, 21);
    const letterContent = `Hai Lili sayang... \n\nNggak kerasa ya, udah satu tahun kita bareng. Makasih udah jadi cewek paling sabar, paling baik, dan paling cantik buat aku.\n\nWebsite sederhana ini aku buat spesial buat kamu, biar kita bisa inget terus kenangan-kenangan manis kita. \n\nAku sayang banget sama kamu! ‚ù§Ô∏è\n\n- Ridho`;

    const galleryData = [
      { type: 'image', src: 'https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=600&q=80', caption: 'Ingat foto ini? Awal cerita kita dimulai. ‚ú®' },
      
      // --- NEW: SPOTIFY STYLE CARD ---
      { 
        type: 'music-card', 
        img: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?w=600&q=80', // GANTI FOTO BERDUA DISINI
        title: 'Kita Usahakan Rumah Itu',
        artist: 'Sal Priadi',
        caption: 'Lagu ini menggambarkan kita banget. ‚ù§Ô∏è' 
      }, 
      
      { type: 'image', src: 'https://images.unsplash.com/photo-1621801306898-6395dc025a4c?w=600&q=80', caption: 'Ketawa bareng kamu itu obat paling ampuh.' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1529626455592-28827725e2e8?w=600&q=80', caption: 'Happy Anniversary! Perjalanan kita masih panjang. üöÄ' },

      // --- 10 PLACEHOLDER TAMBAHAN ---
      { type: 'image', src: 'https://images.unsplash.com/photo-1523438885200-e635ba2c371e?w=600&q=80', caption: 'Momen 5: (Ganti dengan foto liburan kita)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1516585427167-9f4af9627e6c?w=600&q=80', caption: 'Momen 6: (Ganti dengan foto konyol kita)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1519741497674-611481863552?w=600&q=80', caption: 'Momen 7: (Ganti dengan foto wedding undangan?)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1522673607200-1645062cd958?w=600&q=80', caption: 'Momen 8: (Ganti dengan foto wisuda/kelulusan)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=600&q=80', caption: 'Momen 9: (Ganti dengan foto favorite kamu)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1501901609772-df0848060b33?w=600&q=80', caption: 'Momen 10: (Ganti dengan foto sunset bareng)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=600&q=80', caption: 'Momen 11: (Ganti dengan foto candid)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1520857014972-ad6f950900e0?w=600&q=80', caption: 'Momen 12: (Ganti dengan foto makan malam)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1516726817505-f5ed825624d8?w=600&q=80', caption: 'Momen 13: (Ganti dengan foto jalan-jalan)' },
      { type: 'image', src: 'https://images.unsplash.com/photo-1474552226712-ac0f0961a954?w=600&q=80', caption: 'Momen 14: Selamanya bersamamu ‚ù§Ô∏è' }
    ];

    const reasons = [
      "Senyum kamu itu nular banget üòä",
      "Kamu selalu support aku di kondisi apapun",
      "Masakan/Usahamu selalu bikin kangen üç≤",
      "Kamu pendengar yang paling baik",
      "Kita bisa ngomongin hal random berjam-jam",
      "Cuma kamu yang ngerti jokes receh aku ü§£"
    ];

    // --- CORE LOGIC ---
    function startExperience() {
      playShutterSound();
      
      // Start Background Music
      bgWidget.play();
      musicIcon.classList.add('playing');
      isBgPlaying = true;

      const flash = document.getElementById('flash-overlay');
      flash.style.opacity = 1;
      
      setTimeout(() => {
        flash.style.opacity = 0;
        document.getElementById('section-intro').style.display = 'none';
        const letterSec = document.getElementById('section-letter');
        letterSec.style.display = 'block';
        letterSec.style.animation = 'fadeIn 1s forwards';
        setTimeout(typeWriter, 500);
      }, 150);
    }

    let typeIndex = 0;
    const txtElement = document.getElementById('typewriterText');
    const btnLanjut = document.getElementById('btnLanjut');

    function typeWriter() {
      if (typeIndex < letterContent.length) {
        if(typeIndex % 3 === 0) playTypingSound(); 
        const char = letterContent.charAt(typeIndex);
        txtElement.innerHTML += (char === '\n') ? '<br>' : char;
        typeIndex++;
        const randomSpeed = 30 + Math.random() * 50; 
        setTimeout(typeWriter, randomSpeed); 
      } else {
        btnLanjut.classList.add('show');
      }
    }

    // Gallery Logic
    let currentSlide = 0;
    const mediaFrame = document.getElementById('mediaFrame');
    const captionText = document.getElementById('captionText');

    function goToGallery() {
      document.getElementById('section-letter').style.display = 'none';
      const gallerySec = document.getElementById('section-gallery');
      gallerySec.style.display = 'flex';
      gallerySec.style.animation = 'fadeIn 1s forwards';
      loadSlide(0);
      startTimer();
    }

    function loadSlide(index) {
      const item = galleryData[index];
      mediaFrame.style.opacity = 0;
      
      // Stop gallery music if changing slide? 
      // Optional: uncomment to stop music when sliding away
      // if(isGalleryPlaying) toggleGalleryMusic(true);

      setTimeout(() => {
        mediaFrame.innerHTML = '';
        
        if (item.type === 'image') {
          mediaFrame.innerHTML = `<img src="${item.src}" alt="Moment">`;
        } else if (item.type === 'video') {
          mediaFrame.innerHTML = `<iframe src="https://www.youtube.com/embed/${item.id}?rel=0&modestbranding=1" allowfullscreen></iframe>`;
        } else if (item.type === 'music-card') {
          // Render Spotify Card
          mediaFrame.innerHTML = `
            <div class="spotify-card">
              <div class="spotify-img">
                <img src="${item.img}" alt="Album Art">
              </div>
              <div class="spotify-info">
                <h3>${item.title}</h3>
                <p>${item.artist}</p>
              </div>
              <div class="play-circle-btn" id="spotifyPlayBtn" onclick="toggleGalleryMusic()">
                <i class="fas ${isGalleryPlaying ? 'fa-pause' : 'fa-play'}"></i>
              </div>
            </div>
          `;
        }
        
        captionText.textContent = item.caption;
        mediaFrame.style.opacity = 1;
      }, 300);
    }

    function changeSlide(dir) {
      currentSlide = (currentSlide + dir + galleryData.length) % galleryData.length;
      loadSlide(currentSlide);
    }

    // Reason Logic
    function goToReason() {
      document.getElementById('section-gallery').style.display = 'none';
      const reasonSec = document.getElementById('section-reason');
      reasonSec.style.display = 'flex';
      generateReason();
    }

    function backToGallery() {
      document.getElementById('section-reason').style.display = 'none';
      document.getElementById('section-gallery').style.display = 'flex';
    }

    function generateReason() {
      const txt = document.getElementById('reasonText');
      txt.style.opacity = 0;
      setTimeout(() => {
        const rand = Math.floor(Math.random() * reasons.length);
        txt.textContent = `"${reasons[rand]}"`;
        txt.style.opacity = 1;
      }, 300);
    }

    function startTimer() {
      setInterval(() => {
        const now = new Date();
        const diff = now - startDate;
        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
        const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const m = Math.floor((diff / 1000 / 60) % 60);
        const s = Math.floor((diff / 1000) % 60);
        document.getElementById('timerDisplay').innerText = `${d} Hari, ${h} Jam, ${m} Menit, ${s} Detik`;
      }, 1000);
    }

  </script>
</body>
</html>
